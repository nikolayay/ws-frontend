{"remainingRequest":"/Users/nikolay/new-wounds-scars/frontend/node_modules/babel-loader/lib/index.js!/Users/nikolay/new-wounds-scars/frontend/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/nikolay/new-wounds-scars/frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nikolay/new-wounds-scars/frontend/src/components/auth/Login.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/nikolay/new-wounds-scars/frontend/src/components/auth/Login.vue","mtime":1556259447013},{"path":"/Users/nikolay/new-wounds-scars/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/nikolay/new-wounds-scars/frontend/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/nikolay/new-wounds-scars/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/nikolay/new-wounds-scars/frontend/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.regexp.replace\";\nimport \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"/Users/nikolay/new-wounds-scars/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { LOGIN_MUTATION } from \"@/graphql/mutations\";\nimport Vue from \"vue\";\nimport VeeValidate from \"vee-validate\";\nimport { set } from \"@/session\";\nVue.use(VeeValidate, {\n  events: \"\"\n});\nexport default {\n  name: \"Login\",\n  title: \"Login | \".concat(process.env.VUE_APP_NAME),\n  data: function data() {\n    return {\n      email: \"\",\n      password: \"\"\n    };\n  },\n  methods: {\n    login: function () {\n      var _login = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee() {\n        var _this = this;\n\n        var valid, res;\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return this.$validator.validateAll();\n\n              case 2:\n                valid = _context.sent;\n\n                if (!valid) {\n                  _context.next = 9;\n                  break;\n                }\n\n                this.$Progress.start();\n                _context.next = 7;\n                return this.$apollo.mutate({\n                  mutation: LOGIN_MUTATION,\n                  variables: {\n                    email: this.email,\n                    password: this.password\n                  }\n                }).catch(function (_ref) {\n                  var message = _ref.message;\n\n                  _this.$Progress.fail();\n\n                  _this.$toast.open({\n                    message: message,\n                    type: \"is-danger\",\n                    position: \"is-bottom\"\n                  });\n                });\n\n              case 7:\n                res = _context.sent;\n\n                if (res) {\n                  this.$Progress.finish();\n                  this.$session.set(\"jwt\", res.data.login.token);\n                  this.$toast.open({\n                    message: \"Login successful!\",\n                    type: \"is-success\",\n                    position: \"is-bottom\",\n                    duration: 5000\n                  });\n                  this.$router.replace(\"/\");\n                }\n\n              case 9:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function login() {\n        return _login.apply(this, arguments);\n      }\n\n      return login;\n    }()\n  }\n};",{"version":3,"sources":["Login.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuCA,SAAA,cAAA,QAAA,qBAAA;AACA,OAAA,GAAA,MAAA,KAAA;AACA,OAAA,WAAA,MAAA,cAAA;AACA,SAAA,GAAA,QAAA,WAAA;AAEA,GAAA,CAAA,GAAA,CAAA,WAAA,EAAA;AACA,EAAA,MAAA,EAAA;AADA,CAAA;AAIA,eAAA;AACA,EAAA,IAAA,EAAA,OADA;AAEA,EAAA,KAAA,oBAAA,OAAA,CAAA,GAAA,CAAA,YAAA,CAFA;AAGA,EAAA,IAHA,kBAGA;AACA,WAAA;AACA,MAAA,KAAA,EAAA,EADA;AAEA,MAAA,QAAA,EAAA;AAFA,KAAA;AAIA,GARA;AASA,EAAA,OAAA,EAAA;AACA,IAAA,KADA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBAEA,KAAA,UAAA,CAAA,WAAA,EAFA;;AAAA;AAEA,gBAAA,KAFA;;AAAA,qBAIA,KAJA;AAAA;AAAA;AAAA;;AAKA,qBAAA,SAAA,CAAA,KAAA;AALA;AAAA,uBAOA,KAAA,OAAA,CACA,MADA,CACA;AACA,kBAAA,QAAA,EAAA,cADA;AAEA,kBAAA,SAAA,EAAA;AAAA,oBAAA,KAAA,EAAA,KAAA,KAAA;AAAA,oBAAA,QAAA,EAAA,KAAA;AAAA;AAFA,iBADA,EAKA,KALA,CAKA,gBAAA;AAAA,sBAAA,OAAA,QAAA,OAAA;;AACA,kBAAA,KAAA,CAAA,SAAA,CAAA,IAAA;;AACA,kBAAA,KAAA,CAAA,MAAA,CAAA,IAAA,CAAA;AACA,oBAAA,OAAA,EAAA,OADA;AAEA,oBAAA,IAAA,EAAA,WAFA;AAGA,oBAAA,QAAA,EAAA;AAHA,mBAAA;AAKA,iBAZA,CAPA;;AAAA;AAOA,gBAAA,GAPA;;AAqBA,oBAAA,GAAA,EAAA;AACA,uBAAA,SAAA,CAAA,MAAA;AAEA,uBAAA,QAAA,CAAA,GAAA,CAAA,KAAA,EAAA,GAAA,CAAA,IAAA,CAAA,KAAA,CAAA,KAAA;AAEA,uBAAA,MAAA,CAAA,IAAA,CAAA;AACA,oBAAA,OAAA,EAAA,mBADA;AAEA,oBAAA,IAAA,EAAA,YAFA;AAGA,oBAAA,QAAA,EAAA,WAHA;AAIA,oBAAA,QAAA,EAAA;AAJA,mBAAA;AAMA,uBAAA,OAAA,CAAA,OAAA,CAAA,GAAA;AACA;;AAjCA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AATA,CAAA","sourcesContent":["<template>\n  <section class=\"container auth-form box\">\n    <b-field\n      :type=\"{'is-danger': errors.has('email')}\"\n      :message=\"errors.first('email')\"\n      label=\"Email\"\n    >\n      <b-input\n        name=\"email\"\n        type=\"email\"\n        v-validate=\"'required|email'\"\n        placeholder=\"Your Email\"\n        v-model=\"email\"\n      ></b-input>\n    </b-field>\n    <b-field\n      :type=\"{'is-danger': errors.has('password')}\"\n      :message=\"errors.first('password')\"\n      label=\"Password\"\n    >\n      <b-input\n        name=\"password\"\n        type=\"password\"\n        password-reveal\n        v-validate=\"'required'\"\n        placeholder=\"Your Password\"\n        v-model=\"password\"\n      ></b-input>\n    </b-field>\n    <br>\n    <a @click.prevent=\"login\" class=\"button is-fullwidth is-primary\">Log In</a>\n    <small>\n      Don`t have an account?\n      <router-link to=\"/signup\">Sign Up.</router-link>\n    </small>\n  </section>\n</template>\n\n<script>\nimport { LOGIN_MUTATION } from \"@/graphql/mutations\";\nimport Vue from \"vue\";\nimport VeeValidate from \"vee-validate\";\nimport { set } from \"@/session\";\n\nVue.use(VeeValidate, {\n  events: \"\"\n});\n\nexport default {\n  name: \"Login\",\n  title: `Login | ${process.env.VUE_APP_NAME}`,\n  data() {\n    return {\n      email: \"\",\n      password: \"\"\n    };\n  },\n  methods: {\n    async login() {\n      const valid = await this.$validator.validateAll();\n\n      if (valid) {\n        this.$Progress.start();\n\n        const res = await this.$apollo\n          .mutate({\n            mutation: LOGIN_MUTATION,\n            variables: { email: this.email, password: this.password }\n          })\n          .catch(({ message }) => {\n            this.$Progress.fail();\n            this.$toast.open({\n              message,\n              type: \"is-danger\",\n              position: \"is-bottom\"\n            });\n          });\n\n        if (res) {\n          this.$Progress.finish();\n\n          this.$session.set(\"jwt\", res.data.login.token);\n\n          this.$toast.open({\n            message: \"Login successful!\",\n            type: \"is-success\",\n            position: \"is-bottom\",\n            duration: 5000\n          });\n          this.$router.replace(\"/\");\n        }\n      }\n    }\n  }\n};\n</script>\n\n<style scoped>\n.auth-form {\n  max-width: 300px;\n}\na.button {\n  margin-bottom: 5px;\n}\n</style>\n"],"sourceRoot":"src/components/auth"}]}